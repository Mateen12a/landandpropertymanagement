<div class="container">
  <div class="page-inner">
  <div class="row">
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">
          <h4 class="card-title">Update Property</h4>
        </div>
        <div class="card-body">
          <form id="updateProperty" class="form__property-update" data-id="<%= user ? user._id : '' %>">
            <div class="form-group">
              <label for="name">Property Name</label>
              <input type="text" class="name form-control" id="name" name="name" value="<%= property.name %>" required>
            </div>

            <div class="form-group">
              <label for="price">Price</label>
              <input class="price form-control" type="number" placeholder="Price" id="price" name="price" value="<%= property.price %>" required>
            </div>

            <div class="form-group">
              <label for="priceDiscount">Price Discount</label>
              <div class="input-group">
                <input class="priceDiscount form-control" type="number" placeholder="Price Discount" id="priceDiscount" name="priceDiscount" value="<%= property.priceDiscount %>">
              </div>
            </div>

            <div class="form-group">
              <label for="description">Description</label>
              <div class="input-group">
                <textarea class="description form-control" placeholder="Description" name="description" id="description" required><%= property.description %></textarea>
              </div>
            </div>

            <div class="form-group">
              <label for="location-street">Street</label>
              <div class="input-group">
                <input class="location-street form-control" type="text" placeholder="Street" name="location[street]" id="location-street" value="<%= property.location.street %>" required>
              </div>
            </div>

            <div class="form-group">
              <label for="location-city">City</label>
              <div class="input-group">
                <input class="location-city form-control" type="text" placeholder="City" name="location[city]" id="location-city" value="<%= property.location.city %>" required>
              </div>
            </div>

            <div class="form-group">
              <label for="location-state">State</label>
              <div class="input-group">
                <input class="location-state form-control" type="text" placeholder="State" name="location[state]" id="location-state" value="<%= property.location.state %>" required>
              </div>
            </div>

            <div class="form-group">
              <label for="area">Area (sqmetre)</label>
              <div class="input-group">
                <input class="area form-control" type="number" placeholder="Area" name="area" id="area" value="<%= property.area %>" required>
              </div>
            </div>

            <h2 class="mb-4">Photos</h2>
            <!-- Cover Image Preview -->
            <div class="property__images-box property__images-box--imageCover">
              <% if (property.imageCover) { %>
                <div class="property__images property__images-imageCover">
                  <img class="cur__prop-img cur__prop-imageCover" src="/img/properties/<%= property.imageCover %>" alt="Cover Image">
                  <button class="property__img-delete">Delete</button>
                </div>
              <% } %>
            </div>

            <!-- Cover Image Upload -->
            <div class="form-group">
              <label for="imageCover">Image Cover</label>
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fa fa-camera"></i></span>
                </div>
                <input class="form-control imageCover-input" type="file" name="imageCover" id="imageCover" accept="image/*">
              </div>
            </div>

            <!-- Image Preview -->
            <div class="property__images-box property__images-box-images">
              <% if (property.images && property.images.length > 0) { %>
                <% property.images.forEach(image => { %>
                  <div class="property__images property__images-event property__images-list">
                    <img class="cur__prop cur__prop-img property__images-item" src="/img/properties/<%= image %>" alt="Property Image">
                    <button class="property__img-delete">Delete</button>
                  </div>
                <% }) %>
              <% } %>
            </div>

            <!-- Image Upload -->
            <div class="form-group">
              <label for="images">Images</label>
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fa fa-images"></i></span>
                </div>
                <input class="form-control images-input" type="file" name="images" id="images" accept="image/*" multiple>
              </div>
            </div>

            <div class="form-group">
              <label for="type">Type</label>
              <div class="input-group">
                <select class="type form-control" name="type" id="type" required onchange="toggleAmenities(this.value)">
                  <option value="sell" <%= property.type === 'sell' ? 'selected' : '' %>>Sell</option>
                  <option value="shortlet" <%= property.type === 'shortlet' ? 'selected' : '' %>>Shortlet</option>
                  <option value="rent" <%= property.type === 'rent' ? 'selected' : '' %>>Rent</option>
                  <option value="land" <%= property.type === 'land' ? 'selected' : '' %>>Land</option>
                </select>
              </div>
            </div>

            <div id="amenities-section">
              <div class="form-group">
                <label for="amenities-bed">Beds</label>
                <div class="input-group">
                  <input class="quantity-bed form-control" type="number" placeholder="Beds" name="amenities[bed]" id="amenities-bed" value="<%= property.amenities.find(a => a.amenity.includes('bed'))?.quantity || 1 %>">
                </div>
              </div>
              <div class="form-group">
                <label for="amenities-bath">Baths</label>
                <div class="input-group">
                  <input class="quantity-bath form-control" type="number" placeholder="Baths" name="amenities[bath]" id="amenities-bath" value="<%= property.amenities.find(a => a.amenity.includes('bath'))?.quantity || 1 %>">
                </div>
              </div>
              <div class="form-group">
                <label for="amenities-toilet">Toilets</label>
                <div class="input-group">
                  <input class="quantity-toilet form-control" type="number" placeholder="Toilets" name="amenities[toilet]" id="amenities-toilet" value="<%= property.amenities.find(a => a.amenity.includes('toilet'))?.quantity || 1 %>">
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="status">Status</label>
              <select class="status form-control" id="status" name="status" required>
                <option value="published" <%= property.status === 'published' ? 'selected' : '' %>>Published</option>
                <option value="closed" <%= property.status === 'closed' ? 'selected' : '' %>>Closed</option>
              </select>
            </div>

            <button type="submit" class="btn btn-primary">Update Property</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
